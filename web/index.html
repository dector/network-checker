<html>
    <head>
        <title>Network checker</title>
        <script type="text/javascript" src="jquery.js"></script>
        <style type="text/css">
            .status { width: 80px }
        </style>
        <script type="text/javascript">
            function recheckHost(statusCell, ip) {
                var status = statusCell.html();

                statusCell.html("Updating");

                $.get("checker", {h: ip}, function(data) {
                    statusCell.html(data);
                });
            }

            function updateTable() {
                var $table = $("table.data tbody");

                $.getJSON("hosts-list", function(json) {
                    var tableText = "";

                    for (var i = 0; i < json.length; i++) {
                        var jsonValue = json[i];
                        tableText += '<tr><th class="status">' + jsonValue.status + '</th>';
                        tableText += '<th class="ip">' + jsonValue.ip + '</th></tr>';
                    }

                    $table.html(tableText);

                    $('th.status').click(function() {
                        var cell = $(this);

                        recheckHost(cell, $('.ip', cell.parent()).html());
                    });
                });
            }

            $(document).ready(function() {
                updateTable();
            });
        </script>
    </head>

    <body>
        <table class="data">
            <thead>
                <tr>
                    <th>Status</th>
                    <th>Host IP</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </body>
</html>